models:
  dispersion_filenames:
    blue: /priv/miner3/skymap/acasey/a-new-scope/scope/tests/grid_1700d_580v_cached/580v_aao_wlmap.cached
#    red:  /priv/miner3/skymap/acasey/a-new-scope/scope/tests/grid_1700d_580v_cached/1700d_aao_wlmap.cached
  flux_filenames:
    blue:
      folder: '/priv/miner3/skymap/acasey/a-new-scope/scope/tests/grid_1700d_580v_cached/580v/'
      re_match: '[s|p](?P<teff>[0-9]+):g\+(?P<logg>[0-9.]+).+z(?P<feh>[0-9.+-]+).+fits.cached$'
#    red: 
#      folder: '/priv/miner3/skymap/acasey/a-new-scope/scope/tests/grid_1700d_580v_cached/1700d/'
#      re_match: '[s|p](?P<teff>[0-9]+):g\+(?P<logg>[0-9.]+).+z(?P<feh>[0-9.+-]+).+fits.cached$'
interpolation: linear
threads: 1
verbosity: debug
normalise_model:
  blue:
    perform: yes
    order: 2
#  red:
#    perform: yes
#    order: 2
normalise_observed:
  blue:
    function: spline 
    perform: yes
    order: 3
    scale: free
    lower_clip: 1.0
    knot_spacing: 200
    upper_clip: 0.2
#  red:
#    function: poly 
#    perform: yes 
#    order: 4
#    scale: free
#    lower_clip: 1.0
#    upper_clip: 5
doppler_correct:
  blue:
    allow_shift: true
#  red:
#    allow_shift: true
smooth_model_flux:
  blue:
    perform: yes
    mode: gaussian
    kernel: free
#  red:
#    perform: yes 
#    mode: gaussian
#    kernel: free
priors:
  teff: uniform 
  logg: uniform 
  feh: uniform
  normalise_observed.blue.scale: gaussian(1.0, 0.02)
  doppler_correct.blue.allow_shift: gaussian(0, 100) #cross_correlate("data/sun.ms.fits", [5150, 5200])
  smooth_model_flux.blue.kernel: gaussian(3, 0.5)
#  normalise_observed.red.scale: gaussian(1.0, 0.02)
#  doppler_correct.red.allow_shift: gaussian(0, 100) #cross_correlate("data/sun.ms.fits", [8400, 8700])
#  smooth_model_flux.red.kernel: gaussian(0.4, 0.1)
solution_method: emcee 
emcee:
  nwalkers: 50
  nsteps: 200 
pre-cache:
  blue:
    kernel: 0.10
    dispersion_filename: /Users/andycasey/thesis/old.scope/standards/UVES580_aao_wlmap.txt
    oversample: true
  red:
    kernel: 0.10
    dispersion_filename: /Users/andycasey/thesis/old.scope/standards/HR21_aao_wlmap.txt
    oversample: true
masks:
  blue:
    - [4500, 5300]
#  red:
#    - [8400, 8401]
#    - [8400, 8497]
#    - [8499, 8541]
#    - [8543, 8661]
#    - [8663, 8800]
#    - [8478, 8497]
#    - [8499, 8518]
#    - [8522, 8541]
#    - [8543, 8562]
#    - [8642, 8661]
#    - [8663, 8682]
weights:
  blue: 1 + 2*np.abs(1 - flux)
  red: 1 + 2*np.abs(1 - flux)
